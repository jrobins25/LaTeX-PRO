/*
debugPanel.ts
    makes the debug panel
    (vibecoded) I couldn't bother to understand this in great detail so it's primarily copy pasted from chatGPT
*/
import { __awaiter } from "tslib";
import { Modal, Setting } from 'obsidian';
export function handleAppendDebugPanel(plugin) {
    return __awaiter(this, void 0, void 0, function* () {
        // Ensure the panel exists
        if (!plugin.panel)
            plugin.panel = new debugPanel();
        plugin.panel.open();
        const textPrompt = new TextPromptModal(plugin.app, "Enter debug text:");
        const text = yield textPrompt.openAndWait();
        if (!text)
            return;
        const keyPrompt = new TextPromptModal(plugin.app, "Enter key (optional):");
        const key = yield keyPrompt.openAndWait();
        plugin.panel.appendContent(text, key || undefined);
    });
}
export class TextPromptModal extends Modal {
    constructor(app, promptText) {
        super(app);
        this.result = null;
        this.promptText = promptText;
    }
    onOpen() {
        const { contentEl } = this;
        contentEl.empty();
        contentEl.createEl("h3", { text: this.promptText });
        let inputEl;
        new Setting(contentEl)
            .addText(text => {
            inputEl = text.inputEl;
            inputEl.focus();
            text.onChange(value => {
                this.result = value;
            });
            // ðŸ”¥ Add ENTER key support (emoji is left in on purpose for enhanced vibe coding experience)
            inputEl.addEventListener("keydown", (evt) => {
                if (evt.key === "Enter") {
                    evt.preventDefault(); // donâ€™t close modal accidentally
                    this.close();
                    this.resolvePromise(this.result);
                }
            });
        });
        new Setting(contentEl)
            .addButton(btn => btn.setButtonText("OK")
            .setCta()
            .onClick(() => {
            this.close();
            this.resolvePromise(this.result);
        }));
    }
    onClose() {
        this.contentEl.empty();
    }
    openAndWait() {
        this.open();
        return new Promise(resolve => {
            this.resolvePromise = resolve;
        });
    }
}
// makes a floating panel for which entire text content can be updated with updateContet(string)
export class debugPanel {
    constructor() {
        this.offsetX = 0;
        this.offsetY = 0;
        this.isDragging = false;
        // Container
        this.container = document.createElement('div'); // creates div in the DOM
        this.container.style.position = 'fixed'; // relative to viewport not any parent element
        this.container.style.bottom = '20px'; // distance from bottom
        this.container.style.right = '20px'; // distance from right
        // this.container.style.top = '50px';
        // this.container.style.left = '50px';
        this.container.style.width = '400px';
        this.container.style.height = '200px';
        this.container.style.minWidth = '300px'; // when resizing don't go below this
        this.container.style.minHeight = '100px'; // and this
        this.container.style.backgroundColor = 'white';
        this.container.style.border = '1px solid black';
        this.container.style.zIndex = '1000'; // stacking order: high value ensures panel is on top
        this.container.style.display = 'flex'; // easy layout of the panel's children
        this.container.style.flexDirection = 'column'; // arranges children vertivally
        this.container.style.borderRadius = '6px'; // rounded corners
        this.container.style.resize = 'both';
        this.container.style.overflow = 'auto';
        // Header for dragging and closing
        this.header = document.createElement('div');
        this.header.textContent = 'Debug Panel latexPro';
        this.header.style.cursor = 'move'; // when cursos atop of this change to move cursor
        this.header.style.display = 'flex';
        this.header.style.backgroundColor = '#eee';
        this.header.style.borderTopLeftRadius = '6px';
        this.header.style.borderTopRightRadius = '6px';
        this.header.style.alignItems = 'flex-end'; // aligns content to bottom
        this.header.style.paddingLeft = '7px'; // small left padding
        // distributes space evenly between children ensuring header is left and close button is right
        this.header.style.justifyContent = 'space-between';
        this.header.style.fontWeight = 'bold';
        this.header.style.borderBottom = '1px solid #ccc';
        // Buttons container
        const buttonsContainer = document.createElement('div');
        buttonsContainer.style.display = 'flex';
        buttonsContainer.style.gap = '4px'; // spacing between buttons
        // Clear Button
        const clearButton = document.createElement('button');
        clearButton.textContent = 'C';
        clearButton.onclick = () => this.clearContent();
        buttonsContainer.appendChild(clearButton);
        // Closoe button
        const closeButton = document.createElement('button');
        closeButton.textContent = 'x';
        closeButton.onclick = () => this.close();
        buttonsContainer.appendChild(closeButton); // adds button as child of header
        this.header.appendChild(buttonsContainer); // add buttons to header
        // Content
        this.content = document.createElement('div');
        this.content.textContent = '';
        this.content.style.padding = '5px 15px';
        this.content.style.flex = '1'; // fill remaining vertical space beneath header
        this.content.style.overflowY = 'auto'; // vertical scrolling
        this.content.style.whiteSpace = 'pre-wrap'; // horizontal text wrapping
        this.content.style.display = 'flex';
        this.content.style.flexDirection = 'column';
        this.content.style.justifyContent = 'flex-start'; // flex-start for top left
        this.content.style.alignItems = 'flex-start';
        this.content.style.userSelect = 'text'; // makes text selectable
        this.content.style.cursor = 'text'; // change cursor to text selector
        // Combine
        this.container.appendChild(this.header);
        this.container.appendChild(this.content);
        // Dragging behavior
        this.header.addEventListener('mousedown', e => this.startDrag(e));
        document.addEventListener('mousemove', e => this.drag(e));
        document.addEventListener('mouseup', () => this.stopDrag());
    }
    open() {
        if (!document.body.contains(this.container)) { // checks if not open yet
            document.body.appendChild(this.container);
        }
    }
    close() {
        this.container.remove();
    }
    clearContent() {
        this.content.innerHTML = '';
    }
    appendContent(newText, key) {
        // if key is provided, remove any existing line with that key
        if (key) {
            const existingLine = this.content.querySelector(`div[data-key="${key}"]`);
            if (existingLine) {
                existingLine.remove();
            }
        }
        const line = document.createElement('div');
        if (key)
            line.dataset.key = key; // store key in div if provided
        // some (css) formatting
        line.textContent = `> ${newText}`; // adds the >
        line.style.display = 'block';
        line.style.whiteSpace = 'pre-wrap';
        line.style.fontFamily = 'monospace';
        line.style.paddingLeft = '1ch'; // adds padding for text
        line.style.textIndent = '-2ch'; // pulls `> ` to the left
        line.style.margin = '2px 0'; // adds whitespace between entries
        // append to content container
        this.content.appendChild(line);
        // scroll to bottom.
        this.content.scrollTop = this.content.scrollHeight;
    }
    startDrag(e) {
        this.isDragging = true;
        this.offsetX = e.clientX - this.container.offsetLeft; // diff between left edge and x-mouse posn
        this.offsetY = e.clientY - this.container.offsetTop; // similar, these two don't make box jump to mouse posn
        e.preventDefault(); // prevents default browser behavior like text selection
    }
    drag(e) {
        if (!this.isDragging)
            return; // if not dragging immediately stop function
        this.container.style.left = `${e.clientX - this.offsetX}px`;
        this.container.style.top = `${e.clientY - this.offsetY}px`;
    }
    stopDrag() {
        this.isDragging = false;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVidWdQYW5lbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImRlYnVnUGFuZWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7RUFJRTs7QUFFRixPQUFPLEVBQUUsS0FBSyxFQUFPLE9BQU8sRUFBQyxNQUFNLFVBQVUsQ0FBQztBQUc5QyxNQUFNLFVBQWdCLHNCQUFzQixDQUFDLE1BQWdCOztRQUN6RCwwQkFBMEI7UUFDMUIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLO1lBQUUsTUFBTSxDQUFDLEtBQUssR0FBRyxJQUFJLFVBQVUsRUFBRSxDQUFDO1FBQ25ELE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUM7UUFFcEIsTUFBTSxVQUFVLEdBQUcsSUFBSSxlQUFlLENBQUMsTUFBTSxDQUFDLEdBQUcsRUFBRSxtQkFBbUIsQ0FBQyxDQUFDO1FBQ3hFLE1BQU0sSUFBSSxHQUFHLE1BQU0sVUFBVSxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQzVDLElBQUksQ0FBQyxJQUFJO1lBQUUsT0FBTztRQUVsQixNQUFNLFNBQVMsR0FBRyxJQUFJLGVBQWUsQ0FBQyxNQUFNLENBQUMsR0FBRyxFQUFFLHVCQUF1QixDQUFDLENBQUM7UUFDM0UsTUFBTSxHQUFHLEdBQUcsTUFBTSxTQUFTLENBQUMsV0FBVyxFQUFFLENBQUM7UUFFMUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsSUFBSSxFQUFFLEdBQUcsSUFBSSxTQUFTLENBQUMsQ0FBQztJQUN2RCxDQUFDO0NBQUE7QUFFRCxNQUFNLE9BQU8sZUFBZ0IsU0FBUSxLQUFLO0lBS3RDLFlBQVksR0FBUSxFQUFFLFVBQWtCO1FBQ3BDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUxmLFdBQU0sR0FBa0IsSUFBSSxDQUFDO1FBTXpCLElBQUksQ0FBQyxVQUFVLEdBQUcsVUFBVSxDQUFDO0lBQ2pDLENBQUM7SUFFRCxNQUFNO1FBQ0YsTUFBTSxFQUFFLFNBQVMsRUFBRSxHQUFH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dUQ7UUFDNUcsQ0FBQyxDQUFDLGNBQWMsRUFBRSxDQUFDLENBQUMsd0RBQXdEO0lBQ2hGLENBQUM7SUFFTyxJQUFJLENBQUMsQ0FBYTtRQUN0QixJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVU7WUFBRSxPQUFPLENBQUMsNENBQTRDO1FBQzFFLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLElBQUksR0FBRyxHQUFHLENBQUMsQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU8sSUFBSSxDQUFDO1FBQzVELElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLEdBQUcsR0FBRyxHQUFHLENBQUMsQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU8sSUFBSSxDQUFDO0lBQy9ELENBQUM7SUFFTyxRQUFRO1FBQ1osSUFBSSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUM7SUFDNUIsQ0FBQztDQUNKIiwic291cmNlc0NvbnRlbnQiOlsiLypcclxuZGVidWdQYW5lbC50c1xyXG4gICAgbWFrZXMgdGhlIGRlYnVnIHBhbmVsXHJcbiAgICAodmliZWNvZGVkKSBJIGNvdWxkbid0IGJvdGhlciB0byB1bmRlcnN0YW5kIHRoaXMgaW4gZ3JlYXQgZGV0YWlsIHNvIGl0J3MgcHJpbWFyaWx5IGNvcHkgcGFzdGVkIGZyb20gY2hhdEdQVFxyXG4qL1xyXG5cclxuaW1wb3J0IHsgTW9kYWwsIEFwcCwgU2V0dGluZ30gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgdHlwZSBsYXRleFBybyBmcm9tICcuLi9tYWluJ1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZUFwcGVuZERlYnVnUGFuZWwocGx1Z2luOiBsYXRleFBybyl7XHJcbiAgICAvLyBFbnN1cmUgdGhlIHBhbmVsIGV4aXN0c1xyXG4gICAgaWYgKCFwbHVnaW4ucGFuZWwpIHBsdWdpbi5wYW5lbCA9IG5ldyBkZWJ1Z1BhbmVsKCk7XHJcbiAgICBwbHVnaW4ucGFuZWwub3BlbigpO1xyXG5cclxuICAgIGNvbnN0IHRleHRQcm9tcHQgPSBuZXcgVGV4dFByb21wdE1vZGFsKHBsdWdpbi5hcHAsIFwiRW50ZXIgZGVidWcgdGV4dDpcIik7XHJcbiAgICBjb25zdCB0ZXh0ID0gYXdhaXQgdGV4dFByb21wdC5vcGVuQW5kV2FpdCgpO1xyXG4gICAgaWYgKCF0ZXh0KSByZXR1cm47XHJcblxyXG4gICAgY29uc3Qga2V5UHJvbXB0ID0gbmV3IFRleHRQcm9tcHRNb2RhbChwbHVnaW4uYXBwLCBcIkVudGVyIGtleSAob3B0aW9uYWwpOlwiKTtcclxuICAgIGNvbnN0IGtleSA9IGF3YWl0IGtleVByb21wdC5vcGVuQW5kV2FpdCgpO1xyXG5cclxuICAgIHBsdWdpbi5wYW5lbC5hcHBlbmRDb250ZW50KHRleHQsIGtleSB8fCB1bmRlZmluZWQpO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgVGV4dFByb21wdE1vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG4gICAgcmVzdWx0OiBzdHJpbmcgfCBudWxsID0gbnVsbDtcclxuICAgIHByb21wdFRleHQ6IHN0cmluZztcclxuICAgIHJlc29sdmVQcm9taXNlITogKHZhbHVlOiBzdHJpbmcgfCBudWxsKSA9PiB2b2lkO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwcm9tcHRUZXh0OiBzdHJpbmcpIHtcclxuICAgICAgICBzdXBlcihhcHApO1xyXG4gICAgICAgIHRoaXMucHJvbXB0VGV4dCA9IHByb21wdFRleHQ7XHJcbiAgICB9XHJcblxyXG4gICAgb25PcGVuKCkge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xyXG5cclxuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJoM1wiLCB7IHRleHQ6IHRoaXMucHJvbXB0VGV4dCB9KTtcclxuXHJcbiAgICAgICAgbGV0IGlucHV0RWw6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpbnB1dEVsID0gdGV4dC5pbnB1dEVsO1xyXG4gICAgICAgICAgICAgICAgaW5wdXRFbC5mb2N1cygpO1xyXG5cclxuICAgICAgICAgICAgICAgIHRleHQub25DaGFuZ2UodmFsdWUgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0ID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyDwn5SlIEFkZCBFTlRFUiBrZXkgc3VwcG9ydCAoZW1vamkgaXMgbGVmdCBpbiBvbiBwdXJwb3NlIGZvciBlbmhhbmNlZCB2aWJlIGNvZGluZyBleHBlcmllbmNlKVxyXG4gICAgICAgICAgICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2dC5rZXkgPT09IFwiRW50ZXJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTsgLy8gZG9u4oCZdCBjbG9zZSBtb2RhbCBhY2NpZGVudGFsbHlcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc29sdmVQcm9taXNlKHRoaXMucmVzdWx0KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidG4gPT5cclxuICAgICAgICAgICAgICAgIGJ0bi5zZXRCdXR0b25UZXh0KFwiT0tcIilcclxuICAgICAgICAgICAgICAgICAgICAuc2V0Q3RhKClcclxuICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNvbHZlUHJvbWlzZSh0aGlzLnJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNsb3NlKCkge1xyXG4gICAgICAgIHRoaXMuY29udGVudEVsLmVtcHR5KCk7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbkFuZFdhaXQoKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XHJcbiAgICAgICAgdGhpcy5vcGVuKCk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlc29sdmVQcm9taXNlID0gcmVzb2x2ZTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gbWFrZXMgYSBmbG9hdGluZyBwYW5lbCBmb3Igd2hpY2ggZW50aXJlIHRleHQgY29udGVudCBjYW4gYmUgdXBkYXRlZCB3aXRoIHVwZGF0ZUNvbnRldChzdHJpbmcpXHJcbmV4cG9ydCBjbGFzcyBkZWJ1Z1BhbmVsIHtcclxuICAgIGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQ7XHJcbiAgICBoZWFkZXI6IEhUTUxEaXZFbGVtZW50O1xyXG4gICAgY29udGVudDogSFRNTERpdkVsZW1lbnQ7XHJcblxyXG4gICAgcHJpdmF0ZSBvZmZzZXRYID0gMDtcclxuICAgIHByaXZhdGUgb2Zmc2V0WSA9IDA7XHJcbiAgICBwcml2YXRlIGlzRHJhZ2dpbmcgPSBmYWxzZTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICAvLyBDb250YWluZXJcclxuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyAvLyBjcmVhdGVzIGRpdiBpbiB0aGUgRE9NXHJcbiAgICAgICAgdGhpcy5jb250YWluZXIuc3R5bGUucG9zaXRpb24gPSAnZml4ZWQnOyAvLyByZWxhdGl2ZSB0byB2aWV3cG9ydCBub3QgYW55IHBhcmVudCBlbGVtZW50XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIuc3R5bGUuYm90dG9tID0gJzIwcHgnOyAgLy8gZGlzdGFuY2UgZnJvbSBib3R0b21cclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5zdHlsZS5yaWdodCA9ICcyMHB4JzsgICAvLyBkaXN0YW5jZSBmcm9tIHJpZ2h0XHJcbiAgICAgICAgLy8gdGhpcy5jb250YWluZXIuc3R5bGUudG9wID0gJzUwcHgnO1xyXG4gICAgICAgIC8vIHRoaXMuY29udGFpbmVyLnN0eWxlLmxlZnQgPSAnNTBweCc7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIuc3R5bGUud2lkdGggPSAnNDAwcHgnO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnN0eWxlLmhlaWdodCA9ICcyMDBweCc7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIuc3R5bGUubWluV2lkdGggPSAnMzAwcHgnOyAvLyB3aGVuIHJlc2l6aW5nIGRvbid0IGdvIGJlbG93IHRoaXNcclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5zdHlsZS5taW5IZWlnaHQgPSAnMTAwcHgnOyAvLyBhbmQgdGhpc1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd3aGl0ZSc7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIuc3R5bGUuYm9yZGVyID0gJzFweCBzb2xpZCBibGFjayc7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIuc3R5bGUuekluZGV4ID0gJzEwMDAnOyAvLyBzdGFja2luZyBvcmRlcjogaGlnaCB2YWx1ZSBlbnN1cmVzIHBhbmVsIGlzIG9uIHRvcFxyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7IC8vIGVhc3kgbGF5b3V0IG9mIHRoZSBwYW5lbCdzIGNoaWxkcmVuXHJcbiAgICAgICAgdGhpcy5jb250YWluZXIuc3R5bGUuZmxleERpcmVjdGlvbiA9ICdjb2x1bW4nOyAvLyBhcnJhbmdlcyBjaGlsZHJlbiB2ZXJ0aXZhbGx5XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIuc3R5bGUuYm9yZGVyUmFkaXVzID0gJzZweCc7IC8vIHJvdW5kZWQgY29ybmVyc1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnN0eWxlLnJlc2l6ZSA9ICdib3RoJztcclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5zdHlsZS5vdmVyZmxvdyA9ICdhdXRvJztcclxuXHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIC8vIEhlYWRlciBmb3IgZHJhZ2dpbmcgYW5kIGNsb3NpbmdcclxuICAgICAgICB0aGlzLmhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIHRoaXMuaGVhZGVyLnRleHRDb250ZW50ID0gJ0RlYnVnIFBhbmVsIGxhdGV4UHJvJztcclxuICAgICAgICB0aGlzLmhlYWRlci5zdHlsZS5jdXJzb3IgPSAnbW92ZSc7IC8vIHdoZW4gY3Vyc29zIGF0b3Agb2YgdGhpcyBjaGFuZ2UgdG8gbW92ZSBjdXJzb3JcclxuICAgICAgICB0aGlzLmhlYWRlci5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xyXG4gICAgICAgIHRoaXMuaGVhZGVyLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcjZWVlJztcclxuICAgICAgICB0aGlzLmhlYWRlci5zdHlsZS5ib3JkZXJUb3BMZWZ0UmFkaXVzID0gJzZweCc7XHJcbiAgICAgICAgdGhpcy5oZWFkZXIuc3R5bGUuYm9yZGVyVG9wUmlnaHRSYWRpdXMgPSAnNnB4JztcclxuICAgICAgICB0aGlzLmhlYWRlci5zdHlsZS5hbGlnbkl0ZW1zID0gJ2ZsZXgtZW5kJzsgLy8gYWxpZ25zIGNvbnRlbnQgdG8gYm90dG9tXHJcbiAgICAgICAgdGhpcy5oZWFkZXIuc3R5bGUucGFkZGluZ0xlZnQgPSAnN3B4JzsgLy8gc21hbGwgbGVmdCBwYWRkaW5nXHJcbiAgICAgICAgLy8gZGlzdHJpYnV0ZXMgc3BhY2UgZXZlbmx5IGJldHdlZW4gY2hpbGRyZW4gZW5zdXJpbmcgaGVhZGVyIGlzIGxlZnQgYW5kIGNsb3NlIGJ1dHRvbiBpcyByaWdodFxyXG4gICAgICAgIHRoaXMuaGVhZGVyLnN0eWxlLmp1c3RpZnlDb250ZW50ID0gJ3NwYWNlLWJldHdlZW4nO1xyXG4gICAgICAgIHRoaXMuaGVhZGVyLnN0eWxlLmZvbnRXZWlnaHQgPSAnYm9sZCc7XHJcbiAgICAgICAgdGhpcy5oZWFkZXIuc3R5bGUuYm9yZGVyQm90dG9tID0gJzFweCBzb2xpZCAjY2NjJztcclxuXHJcbiAgICAgICAgLy8gQnV0dG9ucyBjb250YWluZXJcclxuICAgICAgICBjb25zdCBidXR0b25zQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgYnV0dG9uc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xyXG4gICAgICAgIGJ1dHRvbnNDb250YWluZXIuc3R5bGUuZ2FwID0gJzRweCcgLy8gc3BhY2luZyBiZXR3ZWVuIGJ1dHRvbnNcclxuXHJcbiAgICAgICAgLy8gQ2xlYXIgQnV0dG9uXHJcbiAgICAgICAgY29uc3QgY2xlYXJCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuICAgICAgICBjbGVhckJ1dHRvbi50ZXh0Q29udGVudCA9ICdDJztcclxuICAgICAgICBjbGVhckJ1dHRvbi5vbmNsaWNrID0gKCkgPT4gdGhpcy5jbGVhckNvbnRlbnQoKTtcclxuICAgICAgICBidXR0b25zQ29udGFpbmVyLmFwcGVuZENoaWxkKGNsZWFyQnV0dG9uKVxyXG4gICAgICAgIC8vIENsb3NvZSBidXR0b25cclxuICAgICAgICBjb25zdCBjbG9zZUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xyXG4gICAgICAgIGNsb3NlQnV0dG9uLnRleHRDb250ZW50ID0gJ3gnO1xyXG4gICAgICAgIGNsb3NlQnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgYnV0dG9uc0NvbnRhaW5lci5hcHBlbmRDaGlsZChjbG9zZUJ1dHRvbik7IC8vIGFkZHMgYnV0dG9uIGFzIGNoaWxkIG9mIGhlYWRlclxyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuaGVhZGVyLmFwcGVuZENoaWxkKGJ1dHRvbnNDb250YWluZXIpIC8vIGFkZCBidXR0b25zIHRvIGhlYWRlclxyXG5cclxuICAgICAgICAvLyBDb250ZW50XHJcbiAgICAgICAgdGhpcy5jb250ZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgdGhpcy5jb250ZW50LnRleHRDb250ZW50ID0gJyc7XHJcbiAgICAgICAgdGhpcy5jb250ZW50LnN0eWxlLnBhZGRpbmcgPSAnNXB4IDE1cHgnO1xyXG4gICAgICAgIHRoaXMuY29udGVudC5zdHlsZS5mbGV4ID0gJzEnOyAvLyBmaWxsIHJlbWFpbmluZyB2ZXJ0aWNhbCBzcGFjZSBiZW5lYXRoIGhlYWRlclxyXG4gICAgICAgIHRoaXMuY29udGVudC5zdHlsZS5vdmVyZmxvd1kgPSAnYXV0byc7ICAvLyB2ZXJ0aWNhbCBzY3JvbGxpbmdcclxuICAgICAgICB0aGlzLmNvbnRlbnQuc3R5bGUud2hpdGVTcGFjZSA9ICdwcmUtd3JhcCc7IC8vIGhvcml6b250YWwgdGV4dCB3cmFwcGluZ1xyXG4gICAgICAgIHRoaXMuY29udGVudC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xyXG4gICAgICAgIHRoaXMuY29udGVudC5zdHlsZS5mbGV4RGlyZWN0aW9uID0gJ2NvbHVtbic7XHJcbiAgICAgICAgdGhpcy5jb250ZW50LnN0eWxlLmp1c3RpZnlDb250ZW50ID0gJ2ZsZXgtc3RhcnQnOyAvLyBmbGV4LXN0YXJ0IGZvciB0b3AgbGVmdFxyXG4gICAgICAgIHRoaXMuY29udGVudC5zdHlsZS5hbGlnbkl0ZW1zID0gJ2ZsZXgtc3RhcnQnO1xyXG4gICAgICAgIHRoaXMuY29udGVudC5zdHlsZS51c2VyU2VsZWN0ID0gJ3RleHQnOyAvLyBtYWtlcyB0ZXh0IHNlbGVjdGFibGVcclxuICAgICAgICB0aGlzLmNvbnRlbnQuc3R5bGUuY3Vyc29yID0gJ3RleHQnOyAvLyBjaGFuZ2UgY3Vyc29yIHRvIHRleHQgc2VsZWN0b3JcclxuXHJcbiAgICAgICAgLy8gQ29tYmluZVxyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuaGVhZGVyKTtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmNvbnRlbnQpO1xyXG5cclxuICAgICAgICAvLyBEcmFnZ2luZyBiZWhhdmlvclxyXG4gICAgICAgIHRoaXMuaGVhZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGUgPT4gdGhpcy5zdGFydERyYWcoZSkpO1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIGUgPT4gdGhpcy5kcmFnKGUpKTtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgKCkgPT4gdGhpcy5zdG9wRHJhZygpKTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuKCkge1xyXG4gICAgICAgIGlmICghZG9jdW1lbnQuYm9keS5jb250YWlucyh0aGlzLmNvbnRhaW5lcikpIHsgLy8gY2hlY2tzIGlmIG5vdCBvcGVuIHlldFxyXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuY29udGFpbmVyKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIucmVtb3ZlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xlYXJDb250ZW50KCl7XHJcbiAgICAgICAgdGhpcy5jb250ZW50LmlubmVySFRNTCA9ICcnO1xyXG4gICAgfVxyXG5cclxuICAgIGFwcGVuZENvbnRlbnQobmV3VGV4dDogc3RyaW5nLCBrZXk/OiBzdHJpbmcpe1xyXG4gICAgICAgIC8vIGlmIGtleSBpcyBwcm92aWRlZCwgcmVtb3ZlIGFueSBleGlzdGluZyBsaW5lIHdpdGggdGhhdCBrZXlcclxuICAgICAgICBpZiAoa2V5KXtcclxuICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdMaW5lID0gdGhpcy5jb250ZW50LnF1ZXJ5U2VsZWN0b3I8SFRNTERpdkVsZW1lbnQ+KGBkaXZbZGF0YS1rZXk9XCIke2tleX1cIl1gKVxyXG4gICAgICAgICAgICBpZiAoZXhpc3RpbmdMaW5lKXsgZXhpc3RpbmdMaW5lLnJlbW92ZSgpO31cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGxpbmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBpZiAoa2V5KSBsaW5lLmRhdGFzZXQua2V5ID0ga2V5OyAvLyBzdG9yZSBrZXkgaW4gZGl2IGlmIHByb3ZpZGVkXHJcblxyXG4gICAgICAgIC8vIHNvbWUgKGNzcykgZm9ybWF0dGluZ1xyXG4gICAgICAgIGxpbmUudGV4dENvbnRlbnQgPSBgPiAke25ld1RleHR9YDsgLy8gYWRkcyB0aGUgPlxyXG4gICAgICAgIGxpbmUuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICAgICAgbGluZS5zdHlsZS53aGl0ZVNwYWNlID0gJ3ByZS13cmFwJztcclxuICAgICAgICBsaW5lLnN0eWxlLmZvbnRGYW1pbHkgPSAnbW9ub3NwYWNlJztcclxuICAgICAgICBsaW5lLnN0eWxlLnBhZGRpbmdMZWZ0ID0gJzFjaCcgLy8gYWRkcyBwYWRkaW5nIGZvciB0ZXh0XHJcbiAgICAgICAgbGluZS5zdHlsZS50ZXh0SW5kZW50ID0gJy0yY2gnIC8vIHB1bGxzIGA+IGAgdG8gdGhlIGxlZnRcclxuICAgICAgICBsaW5lLnN0eWxlLm1hcmdpbiA9ICcycHggMCc7IC8vIGFkZHMgd2hpdGVzcGFjZSBiZXR3ZWVuIGVudHJpZXNcclxuXHJcbiAgICAgICAgLy8gYXBwZW5kIHRvIGNvbnRlbnQgY29udGFpbmVyXHJcbiAgICAgICAgdGhpcy5jb250ZW50LmFwcGVuZENoaWxkKGxpbmUpXHJcblxyXG4gICAgICAgIC8vIHNjcm9sbCB0byBib3R0b20uXHJcbiAgICAgICAgdGhpcy5jb250ZW50LnNjcm9sbFRvcCA9IHRoaXMuY29udGVudC5zY3JvbGxIZWlnaHRcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHN0YXJ0RHJhZyhlOiBNb3VzZUV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5pc0RyYWdnaW5nID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLm9mZnNldFggPSBlLmNsaWVudFggLSB0aGlzLmNvbnRhaW5lci5vZmZzZXRMZWZ0OyAvLyBkaWZmIGJldHdlZW4gbGVmdCBlZGdlIGFuZCB4LW1vdXNlIHBvc25cclxuICAgICAgICB0aGlzLm9mZnNldFkgPSBlLmNsaWVudFkgLSB0aGlzLmNvbnRhaW5lci5vZmZzZXRUb3A7IC8vIHNpbWlsYXIsIHRoZXNlIHR3byBkb24ndCBtYWtlIGJveCBqdW1wIHRvIG1vdXNlIHBvc25cclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7IC8vIHByZXZlbnRzIGRlZmF1bHQgYnJvd3NlciBiZWhhdmlvciBsaWtlIHRleHQgc2VsZWN0aW9uXHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBkcmFnKGU6IE1vdXNlRXZlbnQpIHtcclxuICAgICAgICBpZiAoIXRoaXMuaXNEcmFnZ2luZykgcmV0dXJuOyAvLyBpZiBub3QgZHJhZ2dpbmcgaW1tZWRpYXRlbHkgc3RvcCBmdW5jdGlvblxyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnN0eWxlLmxlZnQgPSBgJHtlLmNsaWVudFggLSB0aGlzLm9mZnNldFh9cHhgO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnN0eWxlLnRvcCA9IGAke2UuY2xpZW50WSAtIHRoaXMub2Zmc2V0WX1weGA7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzdG9wRHJhZygpIHtcclxuICAgICAgICB0aGlzLmlzRHJhZ2dpbmcgPSBmYWxzZTtcclxuICAgIH1cclxufVxyXG4iXX0=